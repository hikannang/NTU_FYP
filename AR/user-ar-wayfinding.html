<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Car AR Wayfinding</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />

    <!-- A-Frame and AR.js libraries -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@^0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script
      type="text/javascript"
      src="https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex-location-only.js"
    ></script>
    <script
      type="text/javascript"
      src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>

    <!-- jQuery and Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      type="text/css"
      href="AR/static/css/user-ar-wayfinding.css"
    />
  </head>

  <body>
    <!-- Instructions Modal -->
    <div id="modalInstructions" class="modal">
      <div class="modal-instructions-content">
        <span class="closeInstructions common-close-btn">
          <img
            src="AR/static/images/icons/close-red-icon.png"
            alt="Close Button"
            class="common-close-img"
          />
        </span>
        <h2>AR Wayfinding Instructions</h2>
        <ol>
          <li>Point your camera in the direction of your destination</li>
          <li>Follow the compass arrow at the top of the screen</li>
          <li>
            The distance to your destination is displayed below the compass
          </li>
          <li>When you get close to the car, directions will appear</li>
        </ol>
        <p><strong>Click anywhere to dismiss this message</strong></p>
      </div>
    </div>

    <!-- Error Modal -->
    <div id="modalError" class="modal">
      <div class="modal-error-content">
        <span class="closeError common-close-btn">
          <img
            src="./AR/static/images/icons/close-red-icon.png"
            alt="Close Button"
            class="common-close-img"
          />
        </span>
        <h2>Error</h2>
        <p id="errorText">An error occurred.</p>
        <div class="button-container">
          <button id="reloadButton" class="action-button">Reload</button>
          <button id="backButton" class="action-button">Go Back</button>
        </div>
      </div>
    </div>

    <!-- Car Directions Modal -->
    <div id="modalCarDirections" class="modal">
      <div class="modal-car-directions-content">
        <span class="closeCarDirections common-close-btn">
          <img
            src="AR/static/images/icons/close-red-icon.png"
            alt="Close Button"
            class="common-close-img"
          />
        </span>
        <div class="car-image-container">
          <img
            id="carImage"
            src="AR/static/images/default-car.png"
            alt="Car Image"
          />
        </div>
        <div class="directions-container">
          <h3>Car Location Instructions</h3>
          <p id="directionsText">Loading directions...</p>
        </div>
        <p><strong>Click anywhere to dismiss this message</strong></p>
      </div>
    </div>

    <!-- Compass and Distance Display -->
    <div id="compassDiv">
      <!-- Compass -->
      <div class="compass">
        <div class="arrow"></div>
      </div>
      <p id="distanceFromTarget" class="uiDisplay">Calculating distance...</p>
    </div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
      <div class="spinner"></div>
      <p>Loading...</p>
    </div>

    <!-- AR Scene -->
    <a-scene
      vr-mode-ui="enabled: false"
      arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false"
      renderer="antialias: true; alpha: true"
      device-orientation-permission-ui="enabled: false"
    >
      <!-- Camera -->
      <a-camera gps-projected-camera far="100" rotation-reader></a-camera>

      <!-- 3D model for target location -->
      <a-entity id="arPin"></a-entity>
    </a-scene>

    <!-- Firebase Config Script -->
    <script>
      // Your Firebase configuration
      const firebaseConfig = {
        // Replace with your Firebase project configuration
        apiKey: "AIzaSyBvSNS37RNg1L1hO7u76z1N_4pEExKbjhU",
        authDomain: "bao-car-liao.firebaseapp.com",
        projectId: "bao-car-liao",
        storageBucket: "bao-car-liao.appspot.com",
        messagingSenderId: "584996100412",
        appId: "1:584996100412:web:b072712450169f6ec02639",
        measurementId: "G-G6XF2JEWPV",
      };

      // Initialize Firebase
      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }
    </script>

    <!-- Custom JavaScript -->
    <script src="AR/static/JavaScript/user-ar-wayfinding.js"></script>
  </body>
</html>
