<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up</title>
  <!-- Link to external CSS -->
  <link rel="stylesheet" href="./static/CSS/signup.css">
</head>
<body>
  <div id="signup-container">
    <h1>Create an Account</h1>
    <form id="signup-form">
      <!-- Back Arrow -->
      <button type="button" id="back-arrow" style="display: none;">‚Üê Back</button>

      <!-- Step 1: Email and Password -->
      <div class="step active" id="step-1">
        <h2>Step 1: Account Details</h2>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <input type="password" id="confirm-password" placeholder="Confirm Password" required>
        <button type="button" id="next-1">Next</button>
      </div>

      <!-- Step 2: Personal Information -->
      <div class="step" id="step-2">
        <h2>Step 2: Personal Information</h2>
        <input type="text" id="first-name" placeholder="First Name" required>
        <input type="text" id="last-name" placeholder="Last Name" required>
        <button type="button" id="next-2">Next</button>
      </div>

      <!-- Step 3: Contact Information -->
      <div class="step" id="step-3">
        <h2>Step 3: Contact Information</h2>
        <input type="tel" id="phone" placeholder="Phone Number (8 digits)" required>
        <button type="button" id="next-3">Next</button>
      </div>

      <!-- Step 4: Address -->
      <div class="step" id="step-4">
        <h2>Step 4: Address</h2>
        <textarea id="address" placeholder="Address" rows="3" required></textarea>
        <button type="button" id="next-4">Next</button>
      </div>

      <!-- Step 5: License Information -->
      <div class="step" id="step-5">
        <h2>Step 5: License Information</h2>
        <input type="text" id="license-number" placeholder="License Number" required>
        <input type="date" id="license-issue-date" placeholder="Date of License Issue" required>
        <button type="button" id="next-5">Next</button>
      </div>

      <!-- Step 6: Payment Information -->
      <div class="step" id="step-6">
        <h2>Step 6: Payment Information</h2>
        <input type="text" id="card-number" placeholder="Card Number (16 digits)" required>
        <button type="submit">Sign Up</button>
      </div>
    </form>
    <p>Already have an account? <a href="/index.html">Click here to sign in!</a></p>
  </div>

  <!-- Firebase and App Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js"></script>
  <script src="./static/Javascript/firebase-config.js" type="module"></script>
  <script src="./static/Javascript/auth.js" type="module"></script>
  <script>
    // Multi-step form logic with back arrow
    const steps = document.querySelectorAll('.step');
    const backArrow = document.getElementById('back-arrow');
    let currentStep = 0;

    function showStep(stepIndex) {
      steps.forEach((step, index) => {
        step.classList.remove('active');
        if (index === stepIndex) {
          step.classList.add('active');
        }
      });

      // Show or hide the back arrow
      backArrow.style.display = stepIndex > 0 ? 'inline-block' : 'none';
    }

    function validateStep(stepIndex) {
      if (stepIndex === 0) {
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        const confirmPassword = document.getElementById('confirm-password').value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert('Please enter a valid email address.');
          return false;
        }
        if (!password || !confirmPassword) {
          alert('Please fill in both password fields.');
          return false;
        }
        if (password !== confirmPassword) {
          alert('Passwords do not match.');
          return false;
        }
      }
      return true;
    }

    // Next buttons
    document.getElementById('next-1').addEventListener('click', () => {
      if (validateStep(0)) {
        currentStep++;
        showStep(currentStep);
      }
    });

    document.getElementById('next-2').addEventListener('click', () => {
      currentStep++;
      showStep(currentStep);
    });

    document.getElementById('next-3').addEventListener('click', () => {
      currentStep++;
      showStep(currentStep);
    });

    document.getElementById('next-4').addEventListener('click', () => {
      currentStep++;
      showStep(currentStep);
    });

    document.getElementById('next-5').addEventListener('click', () => {
      currentStep++;
      showStep(currentStep);
    });

    // Back arrow
    backArrow.addEventListener('click', () => {
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    });

    // Handle form submission
    const signupForm = document.getElementById('signup-form');
    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      alert('Redirecting to login page...');
      window.location.href = "/index.html"; // Redirect to login page regardless of errors
    });
  </script>
</body>
</html>